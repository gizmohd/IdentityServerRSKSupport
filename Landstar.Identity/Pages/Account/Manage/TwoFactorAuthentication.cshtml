@page
@model TwoFactorAuthenticationModel
@inject IStringLocalizer<SharedResource> Localizer
@inject IHtmlLocalizer<SharedResource> HtmlLocalizer

@{
  ViewData["Title"] = Localizer["Two-factor authentication"];
  ViewData["ActivePage"] = ManageNavPages.TwoFactorAuthentication;
}

<partial name="_StatusMessage" for="StatusMessage" />
<h4>@ViewData["Title"]</h4>
@if (Model.Is2FaEnabled)
{
  if (Model.RecoveryCodesLeft == 0)
  {
    @HtmlLocalizer["RecoveryCodesHtml_None"]

  }
  else if (Model.RecoveryCodesLeft == 1)
  {
    @HtmlLocalizer["RecoveryCodesHtml_One"]

  }
  else if (Model.RecoveryCodesLeft <= 3)
  {
    @HtmlLocalizer["RecoveryCodesHtml", Model.RecoveryCodesLeft]
  }

  if (Model.IsMachineRemembered)
  {
    <form method="post" style="display: inline-block">
      <button type="submit" class="btn btn-default" asp-page-handler="forget">@Localizer["Forget this browser"]</button>
    </form>
  }
  @* <a asp-page="./Disable2fa" class="btn btn-default">Disable 2FA</a> *@
  <a asp-page="./GenerateRecoveryCodes" class="btn btn-default">@Localizer["Reset recovery codes"]</a>
}
@if (Model.HasPhoneConfigured)
{

  <h5>Multifactor via SMS</h5>
  <form method="post" style="display: inline-block">
    <label asp-for="@Model.PreferMfaOverSms">
      <input type="checkbox" asp-for="@Model.PreferMfaOverSms"  />
      Prefer SMS over Authenticator App
    </label>
    <button type="submit" class="btn btn-default" asp-page-handler="update">Save SMS Preference</button>
  </form>
}


<h5>Authenticator app</h5>
@if (!Model.HasAuthenticator)
{
  <a id="enable-authenticator" asp-page="./EnableAuthenticator" class="btn btn-default">@Localizer["Add authenticator app"]</a>
}
else
{
  <a id="enable-authenticator" asp-page="./EnableAuthenticator" class="btn btn-default">@Localizer["Setup authenticator app"]</a>
  <a id="reset-authenticator" asp-page="./ResetAuthenticator" class="btn btn-default">@Localizer["Reset authenticator app"]</a>
}

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
}